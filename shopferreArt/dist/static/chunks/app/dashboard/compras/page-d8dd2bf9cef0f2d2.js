(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5765],{91:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>_});var t=a(5155),r=a(2115),i=a(6695),l=a(285),d=a(2523),n=a(5057),o=a(9409),c=a(8539),u=a(5365),m=a(2625),x=a(7374),p=a(7223),h=a(1133),g=a(8046),j=a(8390),b=a(8376);let v=["BEAUTY","HOME","TECNO","DEPORTES","ROPA"],f=[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"}],N=[{id:"1",name:"Plancha de Pelo Oryx",category:"BEAUTY"},{id:"2",name:"Freidora de Aire 3.5L",category:"HOME"},{id:"3",name:"Auricular M25",category:"TECNO"},{id:"4",name:"Cafetera Express",category:"HOME"},{id:"5",name:"Smartwatch Pro",category:"TECNO"}];function _(){let[e,s]=(0,r.useState)([{id:Date.now(),product_name:"",existing_product_id:"",quantity:"",unit_cost:"",category:"",is_new_product:!1}]),[a,_]=(0,r.useState)({supplier:"",payment_method:"",notes:""}),[y,w]=(0,r.useState)(!1),[C,E]=(0,r.useState)(""),A=a=>{e.length>1&&s(e.filter(e=>e.id!==a))},k=(a,t,r)=>{s(e.map(e=>{if(e.id===a){let s={...e,[t]:r};if("existing_product_id"===t&&r){let e=N.find(e=>e.id===r);e&&(s.product_name=e.name,s.category=e.category,s.is_new_product=!1)}return"product_name"===t&&r&&!e.existing_product_id&&(s.is_new_product=!0),s}return e}))},P=async t=>{t.preventDefault(),w(!0),E("");try{if(!a.payment_method)throw Error("Selecciona un m\xe9todo de pago");let t=e.filter(e=>e.product_name&&parseFloat(e.quantity)>0&&parseFloat(e.unit_cost)>0);if(0===t.length)throw Error("Agrega al menos un producto v\xe1lido");await new Promise(e=>setTimeout(e,2e3)),E("\xa1Compra registrada exitosamente! El stock se ha actualizado autom\xe1ticamente."),s([{id:Date.now(),product_name:"",existing_product_id:"",quantity:"",unit_cost:"",category:"",is_new_product:!1}]),_({supplier:"",payment_method:"",notes:""})}catch(e){E("Error: ".concat(e.message))}finally{w(!1)}},F=e.reduce((e,s)=>e+(parseFloat(s.quantity)||0)*(parseFloat(s.unit_cost)||0),0);return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Registrar Compra"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Registra nuevas compras y actualiza autom\xe1ticamente el stock de productos."})]}),(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 text-green-600"}),"Informaci\xf3n de la Compra"]}),(0,t.jsx)(i.BT,{children:"Datos generales de la compra que est\xe1s registrando."})]}),(0,t.jsx)(i.Wu,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{htmlFor:"supplier",children:"Proveedor"}),(0,t.jsx)(d.p,{id:"supplier",value:a.supplier,onChange:e=>_({...a,supplier:e.target.value}),placeholder:"Nombre del proveedor (opcional)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{htmlFor:"payment_method",children:"M\xe9todo de Pago *"}),(0,t.jsxs)(o.l6,{value:a.payment_method,onValueChange:e=>_({...a,payment_method:e}),children:[(0,t.jsx)(o.bq,{children:(0,t.jsx)(o.yv,{placeholder:"Seleccionar m\xe9todo de pago"})}),(0,t.jsx)(o.gC,{children:f.map(e=>(0,t.jsx)(o.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)(n.J,{htmlFor:"notes",children:"Notas"}),(0,t.jsx)(c.T,{id:"notes",value:a.notes,onChange:e=>_({...a,notes:e.target.value}),placeholder:"Notas adicionales sobre la compra (opcional)",rows:3})]})]})})]}),(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.A,{className:"h-5 w-5 text-blue-600"}),"Productos de la Compra"]}),(0,t.jsx)(i.BT,{children:"Agrega los productos que est\xe1s comprando. Si el producto ya existe, se actualizar\xe1 el stock autom\xe1ticamente."})]}),(0,t.jsx)(i.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[e.map((s,a)=>(0,t.jsxs)("div",{className:"p-4 border rounded-lg bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h4",{className:"font-medium text-gray-900",children:["Producto #",a+1]}),e.length>1&&(0,t.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>A(s.id),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(p.A,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)(n.J,{children:"Producto Existente"}),(0,t.jsxs)(o.l6,{value:s.existing_product_id,onValueChange:e=>k(s.id,"existing_product_id",e),children:[(0,t.jsx)(o.bq,{children:(0,t.jsx)(o.yv,{placeholder:"Seleccionar producto existente"})}),(0,t.jsxs)(o.gC,{children:[(0,t.jsx)(o.eb,{value:"nuevo",children:"Producto nuevo"}),N.map(e=>(0,t.jsxs)(o.eb,{value:e.id,children:[e.name," (",e.category,")"]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)(n.J,{children:"Nombre del Producto *"}),(0,t.jsx)(d.p,{value:s.product_name,onChange:e=>k(s.id,"product_name",e.target.value),placeholder:"Nombre del producto",disabled:!!s.existing_product_id}),s.is_new_product&&(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,t.jsx)(h.A,{className:"h-3 w-3 text-blue-500"}),(0,t.jsx)("span",{className:"text-xs text-blue-600",children:"Producto nuevo - se crear\xe1 autom\xe1ticamente"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Cantidad *"}),(0,t.jsx)(d.p,{type:"number",value:s.quantity,onChange:e=>k(s.id,"quantity",e.target.value),placeholder:"0",min:"1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Costo Unitario *"}),(0,t.jsx)(d.p,{type:"number",value:s.unit_cost,onChange:e=>k(s.id,"unit_cost",e.target.value),placeholder:"0.00",min:"0",step:"0.01"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(n.J,{children:["Categor\xeda ",s.is_new_product&&"*"]}),(0,t.jsxs)(o.l6,{value:s.category,onValueChange:e=>k(s.id,"category",e),disabled:!!s.existing_product_id,children:[(0,t.jsx)(o.bq,{children:(0,t.jsx)(o.yv,{placeholder:"Seleccionar categor\xeda"})}),(0,t.jsx)(o.gC,{children:v.map(e=>(0,t.jsx)(o.eb,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.J,{children:"Subtotal"}),(0,t.jsxs)("div",{className:"text-lg font-semibold text-green-600 mt-2",children:["$",((parseFloat(s.quantity)||0)*(parseFloat(s.unit_cost)||0)).toLocaleString("es-AR",{minimumFractionDigits:2})]})]})]})]},s.id)),(0,t.jsxs)(l.$,{type:"button",variant:"outline",onClick:()=>{s([...e,{id:Date.now()+Math.random(),product_name:"",existing_product_id:"",quantity:"",unit_cost:"",category:"",is_new_product:!1}])},className:"w-full border-dashed",children:[(0,t.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Agregar Otro Producto"]})]})})]}),(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-5 w-5 text-green-600"}),"Resumen de la Compra"]})}),(0,t.jsx)(i.Wu,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-blue-600",children:"Total de Productos"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.filter(e=>e.product_name&&parseFloat(e.quantity)>0).length})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-green-600",children:"Cantidad Total"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-green-900",children:e.reduce((e,s)=>e+(parseFloat(s.quantity)||0),0)})]}),(0,t.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-purple-600",children:"Total a Pagar"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-purple-900",children:["$",F.toLocaleString("es-AR",{minimumFractionDigits:2})]})]})]})})]}),C&&(0,t.jsxs)(u.Fc,{className:"mb-6 ".concat(C.includes("Error")?"border-red-200 bg-red-50":"border-green-200 bg-green-50"),children:[(0,t.jsx)(h.A,{className:"h-4 w-4 ".concat(C.includes("Error")?"text-red-600":"text-green-600")}),(0,t.jsx)(u.TN,{className:C.includes("Error")?"text-red-800":"text-green-800",children:C})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(l.$,{onClick:P,disabled:y||0===F,className:"bg-green-600 hover:bg-green-700",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Procesando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Registrar Compra"]})}),(0,t.jsx)(l.$,{variant:"outline",onClick:()=>window.history.back(),children:"Cancelar"})]})]})})}},2523:(e,s,a)=>{"use strict";a.d(s,{p:()=>l});var t=a(5155),r=a(2115),i=a(9434);let l=r.forwardRef((e,s)=>{let{className:a,type:r,...l}=e;return(0,t.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"},2625:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},6547:(e,s,a)=>{Promise.resolve().then(a.bind(a,91))},8539:(e,s,a)=>{"use strict";a.d(s,{T:()=>l});var t=a(5155),r=a(2115),i=a(9434);let l=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...r})});l.displayName="Textarea"}},e=>{var s=s=>e(e.s=s);e.O(0,[2848,1149,4070,1765,8441,1684,7358],()=>s(6547)),_N_E=e.O()}]);