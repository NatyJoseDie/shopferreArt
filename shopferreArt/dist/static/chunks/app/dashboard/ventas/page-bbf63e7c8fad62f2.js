(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4725],{651:(e,s,a)=>{Promise.resolve().then(a.bind(a,7843))},1721:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4815:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},6126:(e,s,a)=>{"use strict";a.d(s,{E:()=>l});var t=a(5155);a(2115);var r=a(2085),i=a(9434);let c=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,i.cn)(c({variant:a}),s),...r})}},6438:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(157).A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},7843:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var t=a(5155),r=a(2115),i=a(6695),c=a(285),l=a(5057),n=a(9409),d=a(6126),o=a(5365),x=a(1721),m=a(7374),u=a(8046),h=a(6438),g=a(4815),p=a(7223),j=a(8390),v=a(1133),y=a(8376);let N=[{id:"1",name:"Plancha de Pelo Oryx",cost_price:15e3,stock:2,category:"BEAUTY"},{id:"2",name:"Freidora de Aire 3.5L",cost_price:45e3,stock:1,category:"HOME"},{id:"3",name:"Auricular M25",cost_price:8e3,stock:3,category:"TECNO"},{id:"4",name:"Cafetera Express",cost_price:75e3,stock:8,category:"HOME"},{id:"5",name:"Smartwatch Pro",cost_price:25e3,stock:12,category:"TECNO"}],f=[{id:"1",name:"Distribuidora Norte",markup:20},{id:"2",name:"Comercial Sur",markup:25},{id:"3",name:"Mayorista Centro",markup:15}];function b(){let[e,s]=(0,r.useState)([]),[a,b]=(0,r.useState)("consumidor_final"),[k,_]=(0,r.useState)(""),[A,w]=(0,r.useState)(!1),[C,S]=(0,r.useState)(""),E=a=>{let t=N.find(e=>e.id===a);if(!t)return;let r=e.find(e=>e.product_id===a);r?r.quantity<t.stock&&s(e.map(e=>e.product_id===a?{...e,quantity:e.quantity+1}:e)):s([...e,{id:Date.now(),product_id:a,product_name:t.name,quantity:1,cost_price:t.cost_price,sale_price:$(t.cost_price),max_stock:t.stock}])},q=a=>{s(e.filter(e=>e.product_id!==a))},R=(a,t)=>{if(t<=0){q(a);return}t>N.find(e=>e.id===a).stock||s(e.map(e=>e.product_id===a?{...e,quantity:t}:e))},$=e=>{if("consumidor_final"===a)return 1.4*e;{let s=f.find(e=>e.id===k);return e*(1+(s?s.markup:20)/100)}},T=()=>{s(e.map(e=>({...e,sale_price:$(e.cost_price)})))};(0,r.useState)(()=>{T()},[a,k]);let V=async t=>{t.preventDefault(),w(!0),S("");try{if(0===e.length)throw Error("Agrega al menos un producto a la venta");if("mayorista"===a&&!k)throw Error("Selecciona un cliente mayorista");for(let s of e){let e=N.find(e=>e.id===s.product_id);if(s.quantity>e.stock)throw Error("Stock insuficiente para ".concat(s.product_name,". Disponible: ").concat(e.stock))}await new Promise(e=>setTimeout(e,2e3)),S("\xa1Venta registrada exitosamente! El stock se ha actualizado autom\xe1ticamente."),s([]),_("")}catch(e){S("Error: ".concat(e.message))}finally{w(!1)}},M=e.reduce((e,s)=>e+s.sale_price*s.quantity,0),z=e.reduce((e,s)=>e+(s.sale_price-s.cost_price)*s.quantity,0);return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Registrar Venta"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Registra ventas a consumidores finales y actualiza autom\xe1ticamente el stock."})]}),(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.A,{className:"h-5 w-5 text-blue-600"}),"Tipo de Venta"]}),(0,t.jsx)(i.BT,{children:"Selecciona el tipo de cliente para calcular los precios correctos."})]}),(0,t.jsx)(i.Wu,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.J,{children:"Tipo de Cliente"}),(0,t.jsxs)(n.l6,{value:a,onValueChange:b,children:[(0,t.jsx)(n.bq,{children:(0,t.jsx)(n.yv,{})}),(0,t.jsxs)(n.gC,{children:[(0,t.jsx)(n.eb,{value:"consumidor_final",children:"Consumidor Final (+40%)"}),(0,t.jsx)(n.eb,{value:"mayorista",children:"Cliente Mayorista"})]})]})]}),"mayorista"===a&&(0,t.jsxs)("div",{children:[(0,t.jsx)(l.J,{children:"Cliente Mayorista"}),(0,t.jsxs)(n.l6,{value:k,onValueChange:_,children:[(0,t.jsx)(n.bq,{children:(0,t.jsx)(n.yv,{placeholder:"Seleccionar cliente"})}),(0,t.jsx)(n.gC,{children:f.map(e=>(0,t.jsxs)(n.eb,{value:e.id,children:[e.name," (+",e.markup,"%)"]},e.id))})]})]})]})})]}),(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.A,{className:"h-5 w-5 text-green-600"}),"Productos Disponibles"]}),(0,t.jsx)(i.BT,{children:"Haz clic en los productos para agregarlos a la venta."})]}),(0,t.jsx)(i.Wu,{children:(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:N.map(s=>{let a=$(s.cost_price),r=e.some(e=>e.product_id===s.id),i=e.find(e=>e.product_id===s.id);return(0,t.jsxs)("div",{className:"p-4 border rounded-lg transition-colors ".concat(0===s.stock?"bg-gray-100 opacity-50":r?"bg-blue-50 border-blue-300":"hover:bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:s.name}),(0,t.jsxs)(d.E,{variant:s.stock>5?"default":s.stock>0?"secondary":"destructive",children:["Stock: ",s.stock]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Categor\xeda: ",s.category]}),(0,t.jsxs)("div",{className:"text-lg font-bold text-green-600",children:["$",a.toLocaleString("es-AR")]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Costo: $",s.cost_price.toLocaleString("es-AR")]})]}),s.stock>0?(0,t.jsx)("div",{className:"mt-3",children:r?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>R(s.id,i.quantity-1),children:(0,t.jsx)(h.A,{className:"h-4 w-4"})}),(0,t.jsx)("span",{className:"flex-1 text-center font-medium",children:i.quantity}),(0,t.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>R(s.id,i.quantity+1),disabled:i.quantity>=s.stock,children:(0,t.jsx)(u.A,{className:"h-4 w-4"})})]}):(0,t.jsxs)(c.$,{onClick:()=>E(s.id),className:"w-full",size:"sm",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Agregar"]})}):(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)(c.$,{disabled:!0,className:"w-full",size:"sm",children:"Sin Stock"})})]},s.id)})})})]}),e.length>0&&(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-5 w-5 text-purple-600"}),"Carrito de Venta (",e.length," productos)"]})}),(0,t.jsx)(i.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-medium",children:e.product_name}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["$",e.sale_price.toLocaleString("es-AR")," x ",e.quantity]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-semibold text-green-600",children:["$",(e.sale_price*e.quantity).toLocaleString("es-AR")]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Ganancia: $",((e.sale_price-e.cost_price)*e.quantity).toLocaleString("es-AR")]})]}),(0,t.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>q(e.product_id),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(p.A,{className:"h-4 w-4"})})]})]},e.id))})})]}),e.length>0&&(0,t.jsxs)(i.Zp,{className:"mb-6",children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-5 w-5 text-green-600"}),"Resumen de la Venta"]})}),(0,t.jsx)(i.Wu,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-blue-600",children:"Total de Productos"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:e.reduce((e,s)=>e+s.quantity,0)})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-green-600",children:"Total de la Venta"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-green-900",children:["$",M.toLocaleString("es-AR")]})]}),(0,t.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-sm text-purple-600",children:"Ganancia Total"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-purple-900",children:["$",z.toLocaleString("es-AR")]})]})]})})]}),C&&(0,t.jsxs)(o.Fc,{className:"mb-6 ".concat(C.includes("Error")?"border-red-200 bg-red-50":"border-green-200 bg-green-50"),children:[(0,t.jsx)(v.A,{className:"h-4 w-4 ".concat(C.includes("Error")?"text-red-600":"text-green-600")}),(0,t.jsx)(o.TN,{className:C.includes("Error")?"text-red-800":"text-green-800",children:C})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(c.$,{onClick:V,disabled:A||0===e.length,className:"bg-green-600 hover:bg-green-700",children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Procesando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Registrar Venta"]})}),(0,t.jsx)(c.$,{variant:"outline",onClick:()=>window.history.back(),children:"Volver al Dashboard"})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2848,1149,4070,1765,8441,1684,7358],()=>s(651)),_N_E=e.O()}]);