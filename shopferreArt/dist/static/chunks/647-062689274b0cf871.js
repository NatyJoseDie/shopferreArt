"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[647],{285:(t,e,o)=>{o.d(e,{$:()=>s,r:()=>d});var a=o(5155),r=o(2115),n=o(9708),i=o(2085),c=o(9434);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),s=r.forwardRef((t,e)=>{let{className:o,variant:r,size:i,asChild:s=!1,...l}=t,u=s?n.DX:"button";return(0,a.jsx)(u,{className:(0,c.cn)(d({variant:r,size:i,className:o})),ref:e,...l})});s.displayName="Button"},2523:(t,e,o)=>{o.d(e,{p:()=>i});var a=o(5155),r=o(2115),n=o(9434);let i=r.forwardRef((t,e)=>{let{className:o,type:r,...i}=t;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",o),ref:e,...i})});i.displayName="Input"},4469:(t,e,o)=>{o.d(e,{CartProvider:()=>d,_:()=>s});var a=o(5155),r=o(2115),n=o(7481);let i=(0,r.createContext)(void 0),c="shopvision_cart";function d(t){let{children:e}=t,[o,d]=(0,r.useState)([]),[s,l]=(0,r.useState)(!1),{toast:u}=(0,n.dj)(),[p,f]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{try{localStorage.setItem("__test_localstorage__","test"),localStorage.removeItem("__test_localstorage__"),f(!0),console.log("CartProvider: localStorage is available.")}catch(t){f(!1),console.warn("CartProvider: localStorage is not available. Cart will not persist.",t),u({title:"Advertencia de Almacenamiento",description:"El carrito no se guardar\xe1 entre sesiones porque el almacenamiento local no est\xe1 disponible.",variant:"destructive",duration:7e3})}},[]),(0,r.useEffect)(()=>{if(!p){console.log("CartProvider: Skipping load from localStorage as it's unavailable."),d([]);return}console.log("CartProvider: useEffect - Attempting to load cart from localStorage.");let t=localStorage.getItem(c);if(t)try{let e=JSON.parse(t);Array.isArray(e)&&e.every(t=>t.product&&"string"==typeof t.product.id&&"number"==typeof t.quantity&&"number"==typeof t.priceAtAddition)?(d(e),console.log("CartProvider: Cart loaded successfully from localStorage:",JSON.stringify(e,null,2))):(console.error("CartProvider: Parsed cart from localStorage is not a valid CartItem array. Resetting cart.",e),localStorage.removeItem(c),d([]))}catch(t){console.error("CartProvider: Error parsing cart from localStorage. Resetting cart.",t),localStorage.removeItem(c),d([])}else console.log("CartProvider: No cart found in localStorage. Initializing empty cart."),d([])},[p]),(0,r.useEffect)(()=>{if(!p){console.log("CartProvider: Skipping save to localStorage as it's unavailable.");return}console.log("CartProvider: useEffect - Cart items changed (or initial load complete), current cartItems:",JSON.stringify(o,null,2)),o&&(localStorage.setItem(c,JSON.stringify(o)),console.log("CartProvider: Cart saved to localStorage."))},[o,p]),(0,a.jsx)(i.Provider,{value:{cartItems:o,addItem:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(console.log("CartContext: ===== addItem CALLED ====="),console.log("CartContext: Received product:",JSON.stringify(t,null,2)),console.log("CartContext: Received quantityToAdd:",e),!t||void 0===t.id||void 0===t.name||void 0===t.price||void 0===t.stock){console.error("CartContext: addItem - Product data is incomplete or invalid. ABORTING.",JSON.stringify(t,null,2)),u({title:"Error de Producto",description:"No se puede a\xf1adir un producto con datos incompletos al carrito.",variant:"destructive"});return}if(t.stock<=0){console.error("CartContext: Attempted to add ".concat(t.name," but it's out of stock (stock: ").concat(t.stock,"). ABORTING.")),u({title:"Producto Agotado",description:"".concat(t.name," no est\xe1 disponible actualmente."),variant:"destructive"});return}if(e<=0){console.error("CartContext: Attempted to add ".concat(t.name," with invalid quantity: ").concat(e,". ABORTING.")),u({title:"Cantidad Inv\xe1lida",description:"Por favor, introduce una cantidad v\xe1lida para ".concat(t.name,"."),variant:"destructive"});return}d(o=>{let a;console.log("CartContext: addItem - Inside setCartItems. Current cartItems (prevItems):",JSON.stringify(o,null,2));let r=o.findIndex(e=>e.product.id===t.id);if(console.log("CartContext: addItem - Existing item index for product ID ".concat(t.id,": ").concat(r)),r>-1){let n=[...o],i=n[r],c=i.quantity+e;console.log("CartContext: addItem - Product exists. Current quantity: ".concat(i.quantity,", Adding: ").concat(e,", Proposed new quantity: ").concat(c,", Stock: ").concat(t.stock)),c>t.stock?(console.error("CartContext: Cannot add ".concat(e," more of ").concat(t.name,". Stock: ").concat(t.stock,", In cart: ").concat(i.quantity,", Requested total: ").concat(c,". Stock limit reached.")),u({title:"Stock Insuficiente",description:"Solo quedan ".concat(t.stock," unidades de ").concat(t.name,". Ya tienes ").concat(i.quantity," en el carrito. No se pueden a\xf1adir ").concat(e," m\xe1s."),variant:"destructive"}),a=o):(n[r]={...i,quantity:c},console.log("CartContext: addItem - Updated existing item:",JSON.stringify(n[r],null,2)),u({title:"Cantidad Actualizada",description:"".concat(t.name," (x").concat(c,") en tu carrito.")}),a=n)}else if(console.log("CartContext: addItem - Product ".concat(t.name," is new. Adding quantity: ").concat(e,", Stock: ").concat(t.stock)),e>t.stock)console.error("CartContext: Cannot add ".concat(e," of ").concat(t.name,". Stock: ").concat(t.stock,". Insufficient stock for new item.")),u({title:"Stock Insuficiente",description:"Solo quedan ".concat(t.stock," unidades de ").concat(t.name,". No se pudo a\xf1adir la cantidad solicitada de ").concat(e,"."),variant:"destructive"}),a=o;else{let r={product:t,quantity:e,priceAtAddition:t.price};console.log("CartContext: addItem - Adding new item:",JSON.stringify(r,null,2)),u({title:"Producto A\xf1adido",description:"".concat(t.name," (x").concat(e,") fue a\xf1adido al carrito.")}),a=[...o,r]}return console.log("CartContext: addItem - setCartItems will be called with (updatedItems):",JSON.stringify(a,null,2)),a}),console.log("CartContext: addItem - After setCartItems call (note: state update is async).")},updateItemQuantity:(t,e)=>{console.log("CartContext: updateItemQuantity called for productId ".concat(t," with quantity ").concat(e)),d(o=>{var a,r;let n=!1,i=null===(a=o.find(e=>e.product.id===t))||void 0===a?void 0:a.product;if(!i)return console.error("CartContext: updateItemQuantity - Product with ID ".concat(t," not found in cart.")),o;let c=o.map(o=>o.product.id===t?(n=!0,e<=0)?(console.log("CartContext: updateItemQuantity - Removing product ".concat(o.product.name," due to quantity <= 0.")),u({title:"Producto Eliminado",description:"".concat(o.product.name," ha sido eliminado de tu carrito."),variant:"destructive"}),null):e>o.product.stock?(console.warn("CartContext: updateItemQuantity - Quantity ".concat(e," for ").concat(o.product.name," exceeds stock ").concat(o.product.stock,". Setting to max stock.")),u({title:"Stock Insuficiente",description:"Solo quedan ".concat(o.product.stock," unidades de ").concat(o.product.name,". Cantidad ajustada."),variant:"destructive"}),{...o,quantity:o.product.stock}):(console.log("CartContext: updateItemQuantity - Updating ".concat(o.product.name," to quantity ").concat(e,".")),{...o,quantity:e}):o).filter(t=>null!==t);return n&&(null===(r=c.find(e=>e.product.id===t))||void 0===r?void 0:r.quantity)===e&&e>0&&u({title:"Cantidad Actualizada",description:"La cantidad para ".concat(i.name," es ahora ").concat(e,".")}),c})},removeItem:t=>{console.log("CartContext: removeItem called for productId ".concat(t)),d(e=>{let o=e.find(e=>e.product.id===t),a=e.filter(e=>e.product.id!==t);return o&&u({title:"Producto Eliminado",description:"".concat(o.product.name," ha sido eliminado de tu carrito."),variant:"destructive"}),a})},clearCart:()=>{console.log("CartContext: clearCart called."),d([]),u({title:"Carrito Vac\xedo",description:"Todos los productos han sido eliminados del carrito."})},getCartTotal:()=>o.reduce((t,e)=>t+e.priceAtAddition*e.quantity,0),getItemCount:()=>o.reduce((t,e)=>t+e.quantity,0),isCartOpen:s,setIsCartOpen:l,toggleCart:()=>{console.log("CartContext: toggleCart called. Current state:",s,"New state:",!s),l(t=>!t)}},children:e})}function s(){let t=(0,r.useContext)(i);if(void 0===t)throw Error("useCart must be used within a CartProvider");return t}},7481:(t,e,o)=>{o.d(e,{dj:()=>p});var a=o(2115);let r=0,n=new Map,i=t=>{if(n.has(t))return;let e=setTimeout(()=>{n.delete(t),l({type:"REMOVE_TOAST",toastId:t})},1e6);n.set(t,e)},c=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:o}=e;return o?i(o):t.toasts.forEach(t=>{i(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===o||void 0===o?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},d=[],s={toasts:[]};function l(t){s=c(s,t),d.forEach(t=>{t(s)})}function u(t){let{...e}=t,o=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>l({type:"DISMISS_TOAST",toastId:o});return l({type:"ADD_TOAST",toast:{...e,id:o,open:!0,onOpenChange:t=>{t||a()}}}),{id:o,dismiss:a,update:t=>l({type:"UPDATE_TOAST",toast:{...t,id:o}})}}function p(){let[t,e]=a.useState(s);return a.useEffect(()=>(d.push(e),()=>{let t=d.indexOf(e);t>-1&&d.splice(t,1)}),[t]),{...t,toast:u,dismiss:t=>l({type:"DISMISS_TOAST",toastId:t})}}}}]);